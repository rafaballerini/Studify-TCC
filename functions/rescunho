const { joinVoiceChannel, createAudioPlayer, createAudioResource, NoSubscriberBehavior } = require('@discordjs/voice');
const ytdl = require('ytdl-core');

let voiceConnection = null;
let studyTimer = null; 
let studyTime = 0;



studyTimer = setTimeout(() => {
    player.play(resource);
    connection.subscribe(player);

    studyTime += tempoPomodoro;
}, tempoPomodoro * 60000);




studyTimer = setTimeout(() => {
    connection.play('../assets/yooPausa.mp3');

    studyTime += tempoPomodoro;
}, tempoPomodoro * 60000); // Multiplica o tempo por 60000 para converter para milissegundos

clearTimeout(studyTimer); // Limpa o timer de estudo

// Código para reproduzir o áudio de finalização dos estudos
// voiceConnection.play('./caminho/do/arquivo/finalizacao.mp3');

voiceConnection.disconnect(); // Desconecta do canal de voz
voiceConnection = null; // Reseta a conexão de voz

client.on('voiceStateUpdate', (oldState, newState) => {
if (!voiceConnection || !voiceConnection.channel) return;

if (oldState.member.id === client.user.id && !newState.channel) {
    setTimeout(() => {
    if (!voiceConnection || !voiceConnection.channel) {
        voiceConnection.disconnect();
        voiceConnection = null;
    }
    }, 60000);
}
});